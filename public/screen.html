<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ğ­ĞºÑ€Ğ°Ğ½ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğ¹</title>

<style>
    body {
        margin: 0;
        overflow: hidden;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        background: linear-gradient(180deg, 
            #2ecc71 0%, 
            #ffffff 50%, 
            #3498db 100%
        );
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Ğ›ĞĞ“ĞĞ¢Ğ˜ĞŸĞ« (ÑƒĞ²ĞµĞ»Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğµ)
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .logo-left {
        position: fixed;
        left: 20px;
        top: 20px;
        width: 220px;
        opacity: 0.95;
        z-index: 10;
    }

    .logo-right {
        position: fixed;
        right: 20px;
        top: 20px;
        width: 180px;
        opacity: 0.95;
        z-index: 10;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Ğ—ĞĞ“ĞĞ›ĞĞ’ĞĞš
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .title {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 40px;
        font-weight: 800;
        color: #d63031;
        text-align: center;
        text-shadow: 0 3px 6px rgba(0,0,0,0.25);
        z-index: 5;
        width: 100%;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ĞšĞĞ Ğ¢Ğ
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .map {
        position: absolute;
        top: 57%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 78%;
        max-width: 1300px;
        opacity: 1;
        z-index: 1;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ĞŸĞ£Ğ—Ğ«Ğ Ğ¬ĞšĞ˜-ĞŸĞ Ğ˜Ğ’Ğ•Ğ¢Ğ¡Ğ¢Ğ’Ğ˜Ğ¯
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .bubble {
        position: absolute;
        padding: 12px 20px;
        border-radius: 18px;
        background: rgba(255, 255, 255, 0.95);
        border: 2px solid #1e3799;
        box-shadow: 0 6px 14px rgba(0,0,0,0.25);
        font-size: 22px;
        font-weight: 600;
        animation: bubbleIn 1s ease, floatUp 10s linear forwards;
        white-space: nowrap;
        pointer-events: none;
        z-index: 20;
        max-width: 300px;
        text-align: center;
    }

    @keyframes bubbleIn {
        0% { transform: scale(0.3); opacity: 0; }
        60% { transform: scale(1.1); opacity: 1; }
        100% { transform: scale(1); }
    }

    @keyframes floatUp {
        0% { transform: translateY(0); opacity: 1; }
        80% { transform: translateY(-120px); opacity: 0.8; }
        100% { transform: translateY(-140px); opacity: 0; }
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Ğ¡ĞĞ•Ğ–Ğ˜ĞĞšĞ˜ (3D-ÑÑ„Ñ„ĞµĞºÑ‚)
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .snowflake {
        position: fixed;
        top: -10px;
        color: white;
        font-size: 20px;
        opacity: 0.85;
        filter: drop-shadow(0 0 6px rgba(255,255,255,1));
        pointer-events: none;
        z-index: 2;
        animation-name: fall;
        animation-timing-function: linear;
        animation-iteration-count: infinite;
    }

    @keyframes fall {
        0% {
            transform: translateY(-10px) rotate(0deg);
            opacity: 0.4;
        }
        100% {
            transform: translateY(110vh) rotate(360deg);
            opacity: 1;
        }
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡ ĞŸĞĞ”ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .connection-status {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 8px 16px;
        border-radius: 20px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        font-size: 14px;
        z-index: 100;
        transition: all 0.3s ease;
    }

    .connection-status.connected {
        background: rgba(46, 204, 113, 0.9);
    }

    .connection-status.disconnected {
        background: rgba(231, 76, 60, 0.9);
    }

    .connection-status.connecting {
        background: rgba(241, 196, 15, 0.9);
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Ğ¡Ğ§Ğ•Ğ¢Ğ§Ğ˜Ğš Ğ£Ğ§ĞĞ¡Ğ¢ĞĞ˜ĞšĞĞ’
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .counter {
        position: fixed;
        top: 100px;
        right: 30px;
        background: rgba(255, 255, 255, 0.95);
        padding: 15px 20px;
        border-radius: 15px;
        border: 2px solid #d63031;
        font-size: 18px;
        font-weight: bold;
        color: #d63031;
        z-index: 10;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
</style>
</head>

<body>

<!-- Ğ›ĞĞ“ĞĞ¢Ğ˜ĞŸĞ« -->
<img src="logo2.png" class="logo-left" alt="Ğ›Ğ¾Ğ³Ğ¾Ñ‚Ğ¸Ğ¿ 1">
<img src="logo.png" class="logo-right" alt="Ğ›Ğ¾Ğ³Ğ¾Ñ‚Ğ¸Ğ¿ 2">

<!-- Ğ—ĞĞ“ĞĞ›ĞĞ’ĞĞš -->
<div class="title">Ğ¨ĞºĞ¾Ğ»Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ³Ğ¾ ÑĞ·Ñ‹ĞºĞ° Ğ¸ ĞºÑƒĞ»ÑŒÑ‚ÑƒÑ€Ñ‹ Ğ Ğ¾ÑÑĞ¸Ğ¸ 2025</div>

<!-- Ğ¡Ğ§Ğ•Ğ¢Ğ§Ğ˜Ğš Ğ£Ğ§ĞĞ¡Ğ¢ĞĞ˜ĞšĞĞ’ -->
<div class="counter">
    Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²: <span id="participantCount">0</span>
</div>

<!-- ĞšĞĞ Ğ¢Ğ -->
<img src="map.png" class="map" alt="ĞšĞ°Ñ€Ñ‚Ğ° Ğ Ğ¾ÑÑĞ¸Ğ¸">

<!-- Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡ ĞŸĞĞ”ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯ -->
<div id="connectionStatus" class="connection-status connecting">
    âŒ› ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº ÑĞµÑ€Ğ²ĞµÑ€Ñƒ...
</div>

<script>
/*** WebSocket: Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµĞ¼ Ğ¸Ğ¼ĞµĞ½Ğ° Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ¿ÑƒĞ·Ñ‹Ñ€ÑŒĞºĞ¸ ***/
(function(){
    const url = (location.protocol === 'https:' ? 'wss':'ws') + '://' + location.host + '/ws';
    const ws = new WebSocket(url);

    let isConnected = false;
    let participantCount = 0;
    const connectionStatus = document.getElementById('connectionStatus');
    const participantCountElement = document.getElementById('participantCount');

    function escapeHtml(s) {
        return s.replace(/[&<>"']/g, c => ({
            '&':'&amp;', '<':'&lt;', '>':'&gt;', '"':'&quot;', "'":'&#39;'
        }[c]));
    }

    function updateConnectionStatus(message, status) {
        connectionStatus.textContent = message;
        connectionStatus.className = 'connection-status ' + status;
    }

    function updateParticipantCount() {
        participantCountElement.textContent = participantCount;
    }

    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ñ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
    ws.addEventListener('open', () => {
        console.log('ğŸ“º Screen WebSocket connected');
        isConnected = true;
        updateConnectionStatus('âœ“ ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾ Ğº ÑĞµÑ€Ğ²ĞµÑ€Ñƒ', 'connected');
    });

    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
    ws.addEventListener('error', (error) => {
        console.error('ğŸ“º WebSocket error:', error);
        updateConnectionStatus('âœ— ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ', 'disconnected');
    });

    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ñ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
    ws.addEventListener('close', () => {
        console.log('ğŸ“º WebSocket disconnected');
        isConnected = false;
        updateConnectionStatus('âœ— Ğ¡Ğ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ·Ğ¾Ñ€Ğ²Ğ°Ğ½Ğ¾', 'disconnected');
    });

    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
    ws.addEventListener('message', (ev) => {
        try {
            console.log('ğŸ“º Received message:', ev.data);
            const msg = JSON.parse(ev.data);
            
            if (msg.type === 'joined') {
                participantCount++;
                updateParticipantCount();
                showBubble(msg.name, msg.color);
                console.log('ğŸ‰ Showing bubble for:', msg.name, 'Total participants:', participantCount);
            }
        } catch(e){
            console.error('âŒ Error parsing message:', e);
        }
    });

    function showBubble(name, color) {
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        bubble.innerHTML = "Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ, " + escapeHtml(name) + "!";
        
        // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ†Ğ²ĞµÑ‚ Ğ¸Ğ»Ğ¸ ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹
        const bubbleColor = color || '#'+Math.floor(Math.random()*0xffffff).toString(16).padStart(6,'0');
        bubble.style.borderColor = bubbleColor;
        bubble.style.background = `linear-gradient(135deg, rgba(255,255,255,0.95), ${bubbleColor}20)`;

        const map = document.querySelector('.map');
        const rect = map.getBoundingClientRect();

        // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ñ‹ Ğ² Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ°Ñ… ĞºĞ°Ñ€Ñ‚Ñ‹
        const x = rect.left + 50 + Math.random() * (rect.width - 100);
        const y = rect.top + 50 + Math.random() * (rect.height - 100);

        bubble.style.left = x + "px";
        bubble.style.top = y + "px";

        document.body.appendChild(bubble);

        // Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ Ğ¿ÑƒĞ·Ñ‹Ñ€ĞµĞº Ğ¿Ğ¾ÑĞ»Ğµ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸
        setTimeout(() => {
            if (bubble.parentNode) {
                bubble.parentNode.removeChild(bubble);
            }
        }, 10000);
    }

    // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
    setInterval(() => {
        if (!isConnected && ws.readyState === WebSocket.CLOSED) {
            console.log('ğŸ”„ Screen attempting to reconnect...');
            updateConnectionStatus('âŸ³ ĞŸĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ...', 'connecting');
            location.reload();
        }
    }, 10000);

    // ĞŸĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
    setInterval(() => {
        if (isConnected) {
            console.log('ğŸ“Š Current participants:', participantCount);
        }
    }, 30000);

})();

/*** â„ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ 3D-ÑĞ½ĞµĞ¶Ğ¸Ğ½Ğ¾Ğº â„ ***/
(function createSnow() {
    const snowCount = 25;

    for (let i = 0; i < snowCount; i++) {
        const sn = document.createElement("div");
        sn.className = "snowflake";
        sn.innerHTML = "â„";

        const size = Math.random() * 22 + 10;  
        const left = Math.random() * 100;      
        const duration = Math.random() * 8 + 6; 
        const delay = Math.random() * 5;        

        sn.style.fontSize = size + "px";
        sn.style.left = left + "vw";
        sn.style.animationDuration = duration + "s";
        sn.style.animationDelay = delay + "s";

        document.body.appendChild(sn);
    }

    // ĞŸĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ½ĞµĞ¶Ğ¸Ğ½Ğ¾Ğº (ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 30 ÑĞµĞºÑƒĞ½Ğ´)
    setInterval(() => {
        const snowflakes = document.querySelectorAll('.snowflake');
        snowflakes.forEach(snowflake => {
            if (Math.random() > 0.7) { // 30% chance to update
                snowflake.style.animationDuration = (Math.random() * 8 + 6) + "s";
            }
        });
    }, 30000);
})();
</script>

</body>
</html>
